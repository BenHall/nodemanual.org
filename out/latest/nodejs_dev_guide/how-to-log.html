<!DOCTYPE html><!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Logging</title><meta name="generator" content="ndoc"><meta name="description" content=""><meta name="author" content=""><meta name="viewport" content="width=device-width,initial-scale=1"><!-- CSS--><link rel="stylesheet" href="../resources/csses/bootstrap.css"><link rel="stylesheet" href="../resources/csses/prettify.css"><link rel="stylesheet" href="../resources/csses/refguide_overrides.css"><link rel="stylesheet" href="../resources/csses/devguide_overrides.css"><!-- end CSS--><script src="../resources/javascripts/jquery.js"></script><script src="../resources/javascripts/clicker.js"></script><script src="../resources/javascripts/jquery.collapse.js"></script><script src="../resources/javascripts/jquery.cookie.js"></script><script src="../resources/javascripts/bootstrap-dropdown.js"></script></head><body onload="styleCode()"><div class="topbar"><div class="fill"><div id="topSection" class="container"><ul class="nav"><li data-dropdown="dropdown" class="dropdown"><a href="#" class="dropdown-toggle brand"></a><ul class="dropdown-menu"><li><a href="http://nodebits.org/">Nodebits</a></li></ul></li></ul><ul class="nav"><li id="node_js_ref"><a href="../nodejs_ref_guide/index.html">Node JS Reference</a></li><li id="nodejs_dev_guide"><a href="../nodejs_dev_guide/index.html">Node JS Manual</a></li><li id="js_doc"><a href="../js_doc/index.html">Javascript Reference</a></li></ul><form id="searchbox" action="" class="pull-right"><input name="query" type="text" placeholder="Search Documentation" title="Search across all the documentation types" class="span3"></form></div></div></div><header id="overview" class="jumbotron masthead"><a href="http://c9.io/" title="cloud9 ide" target="_blank" class="c9-sponsor"></a><div class="inner"><div class="container"><h1>Node.js Manual</h1><p class="lead"></p></div></div></header><div class="container"><div class="content"><div class="row"><div class="span5 offset4"><div id="sidebar"><div id="well"><h2>Node.js Manual</h2><h3>Overview</h3><ul class="menu"><li><div class="menu-item"><a href="npm.html" class="menuLink">Node Package Manager</a></div><ul class="menuTwo"><li><div class="menu-item"><a href="how-to-access-module-package-info.html" class="menuLink class">Accessing Module Package Info</a></div></li><li><div class="menu-item"><a href="what-is-node-core-verus-userland.html" class="menuLink class">Nodecore versus Userland   </a></div></li><li><div class="menu-item"><a href="what-is-the-file-package-json.html" class="menuLink class">File Package JSON    </a></div></li></ul></li><li><div class="menu-item"><a href="what-is-require.html" class="menuLink">Understanding require()                            </a></div></li><li><div class="menu-item"><a href="how-to-use-nodejs-repl.html" class="menuLink">Execute Node.js on the Command Line with REPL</a></div></li><li><div class="menu-item"><a href="how-to-debug-nodejs-applications.html" class="menuLink">Debugging Node.js Applications    </a></div></li><li><div class="menu-item"><a href="how-to-use-util-inspect.html" class="menuLink">Debugging with Util.Inspect()         </a></div></li><li><div class="menu-item"><a href="how-to-write-asynchronous-code.html" class="menuLink">Writing Asynchronous Code                                                        </a></div></li><li><div class="menu-item"><a href="what-are-callbacks.html" class="menuLink">Understanding Callbacks</a></div></li><li><div class="menu-item"><a href="what-are-event-emitters.html" class="menuLink">Understanding Event Emitters</a></div></li></ul><h3>Tutorials</h3><ul class="menu"><li><div class="menu-item"><a href="how-to-create-default-parameters-for-functions.html" class="menuLink">Creating Default Parameters for Functions</a></div></li><li><div class="menu-item"><a href="what-is-the-arguments-object.html" class="menuLink">The Arguments Object         </a></div></li><li><div class="menu-item"><a href="how-to-log.html" class="menuLink">Logging</a></div></li><li><div class="menu-item"><a href="how-to-read-files-in-nodejs.html" class="menuLink">Reading Files            </a></div></li><li><div class="menu-item"><a href="how-to-write-files-in-nodejs.html" class="menuLink">Writing to Files               </a></div></li><li><div class="menu-item"><a href="what-are-the-built-in-timer-functions.html" class="menuLink">Using Timer Functions Correctly</a></div></li><li><div class="menu-item"><a href="how-to-get-colors-on-the-command-line.html" class="menuLink">Colors on the Command Line    </a></div></li><li><div class="menu-item"><a href="how-to-parse-command-line-arguments.html" class="menuLink">Parsing Command Line Arguments     </a></div></li><li><div class="menu-item"><a href="how-to-prompt-for-command-line-input.html" class="menuLink">Prompting for Command Line Input         </a></div></li><li><div class="menu-item"><a href="security.html" class="menuLink">Security     </a></div></li><li><div class="menu-item"><span class="menuLink">HTTP Servers and Clients</span></div><ul class="menuTwo"><li><div class="menu-item"><a href="HTTP-servers.html" class="menuLink">Creating an HTTP Server</a></div></li><li><div class="menu-item"><a href="how-to-create-a-HTTPS-server.html" class="menuLink">Creating an HTTPS Server</a></div></li><li><div class="menu-item"><a href="how-to-serve-static-files.html" class="menuLink">Serving Files                   </a></div></li><li><div class="menu-item"><a href="how-to-read-POST-data.html" class="menuLink">Reading POST Data</a></div></li><li><div class="menu-item"><a href="how-to-handle-multipart-form-data.html" class="menuLink">Handling Multi-Part Form Data</a></div></li><li><div class="menu-item"><a href="how-to-create-a-HTTP-request.html" class="menuLink">Creating HTTP GET and POST Requests                                 </a></div></li><li><div class="menu-item"><a href="how-to-access-query-string-parameters.html" class="menuLink">Accessing Query String Parameters             </a></div></li></ul></li><li><div class="menu-item"><a href="how-to-store-local-config-data.html" class="menuLink">Storing Local Data       </a></div></li><li><div class="menu-item"><a href="how-to-search-files-and-directories-in-nodejs.html" class="menuLink">Searching for Files     </a></div></li><li><div class="menu-item"><a href="how-to-use-the-path-module.html" class="menuLink">Using the path module</a></div></li><li><div class="menu-item"><a href="what-is-the-error-object.html" class="menuLink">The Error Object</a></div></li><li><div class="menu-item"><a href="what-is-try-catch.html" class="menuLink">Understanding try/catch</a></div></li><li><div class="menu-item"><a href="what-are-the-error-conventions.html" class="menuLink">Understanding the Error Conventions</a></div></li><li><div class="menu-item"><a href="how-to-spawn-a-child-process.html" class="menuLink">Spawning Child Processes</a></div></li><li><div class="menu-item"><span class="menuLink">Buffers</span></div><ul class="menuTwo"><li><div class="menu-item"><a href="how-to-use-buffers.html" class="menuLink">Using Buffers                  </a></div></li></ul></li><li><div class="menu-item"><a href="streams.html" class="menuLink">Understanding Streams</a></div><ul class="menuTwo"><li><div class="menu-item"><a href="how-to-use-fs-create-read-stream.html" class="menuLink">Using fs.createReadStream()     </a></div></li><li><div class="menu-item"><a href="how-to-use-fs-create-write-stream.html" class="menuLink">Using fs.createWriteStream()</a></div></li><li><div class="menu-item"><a href="how-to-use-stream-pipe.html" class="menuLink">Using the Stream Pipe                    </a></div></li></ul></li><li><div class="menu-item"><a href="how-to-create-a-custom-repl.html" class="menuLink">Creating a Custom REPL</a></div></li><li><div class="menu-item"><a href="cryptography.html" class="menuLink">Cryptography</a></div><ul class="menuTwo"><li><div class="menu-item"><a href="how-to-use-crypto-module.html" class="menuLink">Using the crypto Module    </a></div></li><li><div class="menu-item"><a href="how-to-use-the-tls-module.html" class="menuLink">Using the tls Module    </a></div></li></ul></li></ul><h3>Reference</h3><ul class="menu"><li><div class="menu-item"><a href="globals-in-node-js.html" class="menuLink">A (Brief) List of Globals in Node.js</a></div></li><li><div class="menu-item"><a href="the-process-module.html" class="menuLink">The Process Module    </a></div></li><li><div class="menu-item"><a href="the-console-module.html" class="menuLink">The Console Module      </a></div></li><li><div class="menu-item"><a href="what-is-json.html" class="menuLink">About JSON </a></div></li><li><div class="menu-item"><a href="what-are-truthy-and-falsy-values.html" class="menuLink">Defining "Truthy" and "Falsy" values</a></div></li><li><div class="menu-item"><a href="using-ECMA5-in-nodejs.html" class="menuLink">Using ECMA5 in Node.js           </a></div></li></ul></div></div></div><div class="span11"><div id="content" class="dev_guide"><p><div class='title'><a class="hiddenLink" id="logging"></a></p>  <h3>Logging</h3> <span class="cite">by Joshua Holbrook</span>

 <p></div>
Many processes, including most servers, write logs in one form or another. Some reasons for logging include debugging, keeping track of users and resource usage, and reporting application state.</p>  <a class="hiddenLink" id="simple-logging"></a>

 <h4>Simple Logging</h4> <p>The simplest form of logging just involves using <code>console.log</code> or one of the other standard output methods. In this approach, any information is printed to <code>stdout</code> where it can either be read by the developer as it occurs, or, for example, redirected to a log file: </p>  <pre><code>console.log(&apos;Web Server started, waiting for connections...&apos;);</code></pre> <p>Because it&apos;s so simple, <code>console.log()</code> is by far the most common way of logging data in Node.js.</p>  <a class="hiddenLink" id="custom-logging"></a>

 <h4>Custom Logging</h4> <p>Logging only with functions such as <code>console.log()</code> is not ideal for every use case, however.  Many applications have some sort of debugging mode, for example, that shows the user much more output than normal execution.  To do something like this, a better idea is to write your own simple logger, and use it instead of <code>console.log()</code>. </p>  <p>Here is an example of a basic custom logging module with configurable debugging levels:</p>  <pre><code>  var logger = exports;

  logger.log = function(level, message) {
    var levels = [&apos;info&apos;, &apos;warn&apos;, &apos;error&apos;];
    if (levels.indexOf(level) &gt;= levels.indexOf(logger.debugLevel) ) {
      if (typeof message !== &apos;string&apos;) {
        message = level + &quot;: &quot; + JSON.stringify(message);
      };

      console.log(message);
    }
  }</code></pre> <p>Save this code in a file called <code>logger.js</code>. You can then import this module, and use it like this:</p>  <pre><code>  var logger = require(&apos;./logger&apos;);
  logger.debugLevel = &apos;warn&apos;;
  logger.log(&apos;info&apos;, &apos;Everything started properly.&apos;);
  logger.log(&apos;warn&apos;, &apos;Running out of memory...&apos;);
  logger.log(&apos;error&apos;, { error: &apos;flagrant&apos;});</code></pre> <p>Because <code>logger.debugLevel</code> was set to <code>warn</code>, the warning message and the error would both be displayed, but the <code>info</code> message would not be.</p>  <p>The advantage here is that the behavior of our logging mechanisms can now be modified and controlled from a central part of our code. In this case, logging levels were added, and messages are converted to JSON if they aren&apos;t already in string form. There is a lot more that could be done here&mdash;saving logs to a file, pushing them to a database, setting custom colors and formatting the output&mdash;but by the time you want that much functionality from your custom logging function, it might be time to use an already-existing library.</p>  <a class="hiddenLink" id="extended-logging-functionality"></a>

 <h4>Extended Logging Functionality</h4> <p><a href="https://github.com/indexzero/winston">Winston</a> is a multi-transport and asynchronous logging library for Node.js.  It is conceptually similar to our custom logger, but comes with a wide variety of useful features and functionality baked in. In addition, <code>winston</code> is battle-hardened by internal use at <a href="http://nodejitsu.com/">Nodejitsu</a>.</p>  <p>Here&apos;s an example of setting up a <code>winston</code> logger.  This example includes most of the transports one could ever possibly want&mdash;most use cases will only warrant a few of these:</p>  <pre><code>  var winston = require(&apos;winston&apos;);

  require(&apos;winston-riak&apos;).Riak;
  require(&apos;winston-mongo&apos;).Mongo;
  var logger = new (winston.Logger)({
    transports: [
      new winston.transports.Console()
      new winston.transports.File({ filename: &apos;path/to/all-logs.log&apos; })
      new winston.transports.Couchdb({ &apos;host&apos;: &apos;localhost&apos;, &apos;db&apos;: &apos;logs&apos; })
      new winston.transports.Riak({ bucket: &apos;logs&apos; })
      new winston.transports.MongoDB({ db: &apos;db&apos;, level: &apos;info&apos;})
    ]
    exceptionHandlers: [
      new winston.transports.File({ filename: &apos;path/to/exceptions.log&apos; })
    ]
  });</code></pre> <p>Here, we have instantiated a new <code>winston</code> logger, and provided a number of logging transports.  Winston has built-in support for configurable logging levels, and provides alias methods for each configured logging level.  For example, <code>winston.warn(x)</code> is an alias for <code>winston.log(&apos;warn&apos;, x)</code>.  Thus, the following:</p>  <pre><code>  logger.warn(&apos;Hull Breach Detected on Deck 7!&apos;); </code></pre> <p>Would output to the screen:</p>  <pre><code>  warn: Hull Breach Detected on Deck 7!</code></pre> <p>Because of the file transport we set up, winston also logged the warning to &apos;somefile.log&apos;.  After the <code>logger.warn</code> call we just used, the log file, <code>somefile.log</code>, would contain the following output:</p>  <pre><code>  $ cat somefile.log 
  {&apos;level&apos;:&apos;warn&apos;,&apos;message&apos;:&apos;Hull Breach Detected on Deck 7!&apos;}</code></pre> <p>Note that winston&apos;s file logger formats the logs differently for file logging (JSON in this case) than it does for the console transport.</p>  <p>Winston also supports logging to Riak, CouchDB, MongoDB and even <a href="http://loggly.com">Loggly</a>.  The <code>logger.warn()</code> call we used before also put the same message into each database, according to the options we gave to each transport.</p>  <p>For further information, please see the <a href="https://github.com/indexzero/winston">thorough documentation for Winston</a>.</p></div><div id="disqus_thread"></div></div></div></div><footer id="footer"><div class="container"><div class="footer-text">Thanks to these content providors | &#169; 2012:</div><div class="sponsors"><a href="http://c9.io/" title="cloud9 ide" target="_blank" class="c9-logo"></a><a href="http://www.joyent.com/" title="joyent" target="_blank" class="joyent-logo"></a><a href="http://www.mozilla.org/" title="mozilla" target="_blank" class="mozilla-logo"></a><a href="http://nodejitsu.com/" title="nodejitsu" target="_blank" class="nodejitsu-logo"></a></div></div></footer></div><!-- scripts concatenated and minified via ant build script--><script defer src="../resources/javascripts/plugins.js"></script>
<script defer src="../resources/javascripts/prettify.js"></script>
<script defer src="../resources/javascripts/prettify-extension.js"></script>
<script defer src="../resources/javascripts/script.js"></script>
<script defer src="../resources/javascripts/disqus-ext.js"></script>
<!-- end scripts--><!--[if lt IE 7]><script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script><script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})

</script><![endif]--></body></html>
