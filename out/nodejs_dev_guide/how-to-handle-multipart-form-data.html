<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Node.js Developer's Guide</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/sh.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
      }
    </style>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
  <script src="../js/toc.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        //$("#toc").accordion({ event: 'mouseover' }, { autoHeight: false });
    });
    </script>
    <link href="../css/style_override.css" rel="stylesheet">
  </head>

  <body>
    <!--
        <div class="topbar">
          <div class="topbar-inner">
            <div class="container-fluid">
              <a class="brand" href="#">Project name</a>
              <ul class="nav">
                <li class="active"><a href="#">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
              </ul>
              <p class="pull-right">Logged in as <a href="#">username</a></p>
            </div>
          </div>
        </div>
    -->

    <div class="container-fluid">
      <div class="sidebar">
        <div id="toc" class="well">
        <h5>Overview</h5>
<div>
<ul>
<li><a class="upper" href="introduction.html">Introduction</a></li>
<li><a class="upper" href="npm.html">Node Package Manager</a></li>
<li><a class="upper" href="how-to-use-nodejs-repl.html">Execute Node.js on the Command Line with REPL</a></li>
<li><a class="upper" href="how-to-debug-nodejs-applications.html">Debugging Node.js Applications</a></li>
<li><a class="upper" href="how-to-write-asynchronous-code.html">Writing Asynchronous Code</a></li>
<li><a class="upper" href="what-are-callbacks.html">Understanding Callbacks</a></li>
<li><a class="upper" href="what-are-event-emitters.html">Understanding Event Emitters</a></li>
</ul>
</div>
<h5>Tutorial </h5>
<div>
<ul>
<li><a class="upper" href="what-are-the-built-in-timer-functions.html">Using Timer Functions Correctly</a></li>
<li><a class="upper" href="how-to-create-a-HTTP-server.html">Serving Files</a></li>
<li><a class="upper" href="security.html">Security</a></li>
<li><a class="upper" href="how-to-store-local-config-data.html">Storing Local Data</a></li>
<li><a class="upper" href="how-to-use-the-path-module.html">Using the path module</a></li>
<li><a class="upper" href="how-to-search-files-and-directories-in-nodejs.html">Searching for Files</a></li>
<li><a class="upper" href="what-is-the-error-object.html">The Error Object</a></li>
<li><a class="upper" href="what-is-try-catch.html">Understanding try/catch()</a></li>
<li><a class="upper" href="what-are-the-error-conventions.html">Understanding the Error Conventions</a></li>
<li><a class="upper" href="how-to-spawn-a-child-process.html">Spawning Child Processes</a></li>
<li><a class="upper" href="buffers.html">Buffers</a></li>
<li><a class="upper" href="what-are-streams.html">Streams</a></li>
<li><a class="upper" href="how-to-create-a-custom-repl.html">Creating a Custom REPL</a></li>
<li><a class="upper" href="cryptography.html">Cryptography</a></li>
<li><a class="upper" href="globals-in-node-js.html">A (Brief) List of Globals in Node.js</a></li>
</ul>
</div>
<h5>Reference </h5>
<div>
<ul>
<li><a class="upper" href="the-process-module.html">The Process Module</a></li>
<li><a class="upper" href="the-console-module.html">The Console Module</a></li>
<li><a class="upper" href="what-is-json.html">About JSON</a></li>
<li><a class="upper" href="what-are-truthy-and-falsy-values.html">Defining "Truthy" and "Falsy" values</a></li>
</ul></div><li><a class="upper" href="using-ECMA5-in-nodejs.html">Using ECMA5 in Node.js</a></li>

</div>
</div>
<div class="content"><p><div class="hero-unit"></p>

<p><a class="hiddenLink" id="handling-multipart-form-data"></a></p>

<h3>Handling Multi-Part Form Data</h3>

<p><span class="cite">by AvianFlu (Last Updated: Sep 09 2011)</span></p>

<p>Handling form data and file uploads properly is an important and complex problem in HTTP servers.  Doing it by hand would involve parsing streaming binary data, writing it to the file system, parsing out additional form data, and several other complex concerns. Luckily, only a very few people will need to worry about it on that deep level. </p>

<p>Felix Geisendorfer, one of the Node.js core committers, wrote a library called <code>node-formidable</code> that handles all the hard parts for you. With its friendly API, you can be parsing forms and receiving file uploads in no time.</p>

<p>This example is taken directly from the <code>node-formidable</code> GitHub page, with some additional explanation added.</p>

<pre><code>var formidable = require('formidable'),
http = require('http'),
util = require('util');

http.createServer(function(req, res) {

  // This if statement is here to catch form submissions, 
  // and initiate multipart form data parsing.     
  if (req.url == '/upload' &amp;&amp; req.method.toLowerCase() == 'post') {

    // Instantiate a new formidable form for processing.
    var form = new formidable.IncomingForm();

    // form.parse() analyzes the incoming stream data, 
    // picking apart the different fields and files for you.
    form.parse(req, function(err, fields, files) {
      if (err) {
        // Check for and handle any errors here.
        console.error(err.message);
        return;
      }

      res.writeHead(200, {'content-type': 'text/plain'});
      res.write('received upload:\n\n');

      // This last line responds to the form submission 
      // with a list of the parsed data and files.
      res.end(util.inspect({fields: fields, files: files}));
    });

    return;
  }

  // If this is a regular request, and not a form submission, then send the form
  res.writeHead(200, {'content-type': 'text/html'});
  res.end(
    '&lt;form action="/upload" enctype="multipart/form-data" method="post"&gt;'+
    '&lt;input type="text" name="title"&gt;&lt;br&gt;'+
    '&lt;input type="file" name="upload" multiple="multiple"&gt;&lt;br&gt;'+
    '&lt;input type="submit" value="Upload"&gt;'+
    '&lt;/form&gt;'
  );
}).listen(8080);
</code></pre>

<p>Using <code>node-formidable</code> is definitely the simplest solution, and it is a battle-hardened, production-ready library. Let userland solve problems like this for you, so that you can get back to writing the rest of your code!</div></p></div>
</div>
<footer>
    <p>&nbsp;</p>
</footer>
        
<script type="text/javascript" src="../js/sh_main.js"></script>
<script type="text/javascript" src="../js/sh_javascript.min.js"></script>
</div>
    </div>

  </body>
</html>